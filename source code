!pip install scapy

from scapy.all import sniff, IP, TCP, UDP

def packet_callback(packet):
  
  if packet.haslayer(IP):
    ip_layer = packet[IP]
    print(f"Source IP: {ip_layer.src} -> Destination IP: {ip_layer.dst}")

    
    if packet.haslayer(TCP):
      tcp_layer = packet[TCP]
      print(f"  Protocol: TCP, Source Port: {tcp_layer.sport}, Destination Port: {tcp_layer.dport}")
      
      if tcp_layer.payload:
        print(f"  Payload: {bytes(tcp_layer.payload)}")
    elif packet.haslayer(UDP):
      udp_layer = packet[UDP]
      print(f"  Protocol: UDP, Source Port: {udp_layer.sport}, Destination Port: {udp_layer.dport}")
      
      if udp_layer.payload:
        print(f"  Payload: {bytes(udp_layer.payload)}")
    else:
      print(f"  Protocol: Other ({ip_layer.proto})")

print("Starting packet capture. Press Ctrl+C to stop.")
try:
  
  sniff(prn=packet_callback, count=10)
except Exception as e:
  print(f"An error occurred during sniffing: {e}")
  print("Packet sniffing in Google Colab may require specific permissions or network configurations.")
  print("Consider running this type of code in a local environment or a VM with appropriate network access.")
